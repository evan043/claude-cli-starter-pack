{
  "plan_id": "ccasp-code-refactoring-phase-4",
  "phase_id": "phase-4",
  "roadmap_slug": "ccasp-code-refactoring",
  "project_name": "Roadmap Domain Decomposition",
  "scale": "L",
  "target_success": 0.95,
  "status": "pending",
  "agent_assignments": {
    "suggested": ["l2-backend-specialist"],
    "current": []
  },
  "phases": [
    {
      "id": 1,
      "name": "Roadmap Domain Decomposition",
      "status": "pending",
      "tasks": [
        {
          "id": "4.1",
          "description": "Split schema.js (1053 LOC, 28 exports) into schema/{validators,generators,migrations}.js",
          "details": "Analyze the 28 exports in src/roadmap/schema.js and group by function: validators (schema validation functions, type checkers), generators (schema generation, default value creation), migrations (schema version migration, upgrade paths). Each module <400 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/roadmap/schema.js", "src/roadmap/schema/"]
        },
        {
          "id": "4.2",
          "description": "Split roadmap-manager.js (1022 LOC) into roadmap/{crud,lifecycle,queries}.js",
          "details": "Decompose src/roadmap/roadmap-manager.js into: crud (create, read, update, delete operations), lifecycle (status transitions, phase progression, completion logic), queries (search, filter, aggregation, reporting). Original file becomes thin re-export wrapper.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/roadmap/roadmap-manager.js", "src/roadmap/manager/"]
        },
        {
          "id": "4.3",
          "description": "Split intelligence.js (954 LOC) into intelligence/{analyzer,recommender,classifier}.js",
          "details": "Decompose src/roadmap/intelligence.js into: analyzer (complexity analysis, dependency detection, effort estimation), recommender (phase ordering, agent assignment, optimization suggestions), classifier (domain classification, issue categorization, priority scoring). Each module <400 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/roadmap/intelligence.js", "src/roadmap/intelligence/"]
        },
        {
          "id": "4.4",
          "description": "Run npm test - verify 135/135 still pass after roadmap decomposition",
          "completed": false,
          "testing": {
            "type": "e2e",
            "command": "npm test"
          }
        }
      ],
      "success_criteria": [
        "schema.js reduced to <200 lines (re-export wrapper)",
        "roadmap-manager.js reduced to <200 lines (re-export wrapper)",
        "intelligence.js reduced to <200 lines (re-export wrapper)",
        "All 28 schema exports preserved",
        "All submodules <400 lines",
        "135/135 tests pass"
      ]
    }
  ],
  "testing_config": {
    "ralph_loop": {
      "enabled": true,
      "maxIterations": 10,
      "testCommand": "npm test"
    }
  }
}
