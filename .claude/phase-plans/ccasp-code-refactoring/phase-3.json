{
  "plan_id": "ccasp-code-refactoring-phase-3",
  "phase_id": "phase-3",
  "roadmap_slug": "ccasp-code-refactoring",
  "project_name": "CLI & Menu Refactoring",
  "scale": "L",
  "target_success": 0.95,
  "status": "pending",
  "agent_assignments": {
    "suggested": ["l2-backend-specialist"],
    "current": []
  },
  "phases": [
    {
      "id": 1,
      "name": "CLI & Menu Refactoring",
      "status": "pending",
      "tasks": [
        {
          "id": "3.1",
          "description": "Extract menu.js display utilities (showHeader, showSuccess, showError, etc.) into cli/display.js (<200 lines)",
          "details": "Identify all display/formatting functions in src/cli/menu.js (showHeader, showSuccess, showError, showWarning, showTable, ASCII art generation, color helpers, box drawing). Move them to src/cli/display.js. Update all references in menu.js to import from display.js.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/cli/menu.js", "src/cli/display.js"]
        },
        {
          "id": "3.2",
          "description": "Extract 20+ menu flows into cli/flows/{main,settings,github,agents,tools,deployment}.js - each <300 lines",
          "details": "Group the 20+ interactive menu flows by domain: main (main menu, help, about), settings (config, preferences), github (GitHub integration flows), agents (agent management flows), tools (tool management flows), deployment (deploy flows). Each flow module exports async functions that handle user interaction for their domain.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/cli/menu.js", "src/cli/flows/"]
        },
        {
          "id": "3.3",
          "description": "Reduce menu.js to thin orchestrator (<300 lines) that imports flows and display utils",
          "details": "After extracting display utilities and flow modules, reduce menu.js to a thin orchestrator that: imports all flow modules, handles menu state transitions, dispatches user selections to the correct flow module. Target <300 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/cli/menu.js"]
        },
        {
          "id": "3.4",
          "description": "Run npm test - verify 135/135 still pass after menu refactoring",
          "completed": false,
          "testing": {
            "type": "e2e",
            "command": "npm test"
          }
        }
      ],
      "success_criteria": [
        "menu.js reduced to <300 lines (thin orchestrator)",
        "Display utilities in cli/display.js (<200 lines)",
        "Flow modules in cli/flows/ (<300 lines each)",
        "All menu functionality preserved",
        "135/135 tests pass"
      ]
    }
  ],
  "testing_config": {
    "ralph_loop": {
      "enabled": true,
      "maxIterations": 10,
      "testCommand": "npm test"
    }
  }
}
