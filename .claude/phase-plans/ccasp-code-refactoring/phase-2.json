{
  "plan_id": "ccasp-code-refactoring-phase-2",
  "phase_id": "phase-2",
  "roadmap_slug": "ccasp-code-refactoring",
  "project_name": "Commands Domain Decomposition",
  "scale": "L",
  "target_success": 0.95,
  "status": "pending",
  "agent_assignments": {
    "suggested": ["l2-backend-specialist"],
    "current": []
  },
  "phases": [
    {
      "id": 1,
      "name": "Commands Domain Decomposition",
      "status": "pending",
      "tasks": [
        {
          "id": "2.1",
          "description": "Split init.js (1521 LOC, 169 functions) into init/{scaffolding,features,templates,deployment,validation}.js - each <300 lines",
          "details": "Analyze the 169 functions in src/commands/init.js and group them by domain: scaffolding (directory creation, file copying), features (feature detection, preset handling), templates (template processing, placeholder replacement), deployment (deploy config generation), validation (input validation, path checks). Create focused modules under src/commands/init/ with the original init.js becoming a thin re-export wrapper.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/commands/init.js", "src/commands/init/"]
        },
        {
          "id": "2.2",
          "description": "Split wizard/actions.js (1451 LOC) into actions/{setup,agents,hooks,skills,github,deployment}.js by action category",
          "details": "Group wizard action functions by their domain: setup (initial configuration), agents (agent creation/management), hooks (hook creation/management), skills (skill creation/management), github (GitHub integration actions), deployment (deploy configuration actions). Each new module should be <300 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/commands/wizard/actions.js", "src/commands/wizard/actions/"]
        },
        {
          "id": "2.3",
          "description": "Verify all exports are re-exported from original entry points (backwards compatibility)",
          "details": "Ensure that src/commands/init.js and src/commands/wizard/actions.js still export all the same named exports they had before the split. Any consumer importing from these paths must continue to work unchanged. Run golden master verification to confirm API surface is preserved.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/commands/init.js", "src/commands/wizard/actions.js"]
        },
        {
          "id": "2.4",
          "description": "Run npm test - verify 135/135 still pass after command decomposition",
          "completed": false,
          "testing": {
            "type": "e2e",
            "command": "npm test"
          }
        }
      ],
      "success_criteria": [
        "init.js reduced to <200 lines (re-export wrapper)",
        "wizard/actions.js reduced to <200 lines (re-export wrapper)",
        "All submodules <300 lines each",
        "All original exports preserved",
        "135/135 tests pass"
      ]
    }
  ],
  "testing_config": {
    "ralph_loop": {
      "enabled": true,
      "maxIterations": 10,
      "testCommand": "npm test"
    }
  }
}
