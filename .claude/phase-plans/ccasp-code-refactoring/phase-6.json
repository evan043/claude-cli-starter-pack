{
  "plan_id": "ccasp-code-refactoring-phase-6",
  "phase_id": "phase-6",
  "roadmap_slug": "ccasp-code-refactoring",
  "project_name": "Agents & Utils Cleanup",
  "scale": "M",
  "target_success": 0.95,
  "status": "pending",
  "agent_assignments": {
    "suggested": ["l2-backend-specialist"],
    "current": []
  },
  "phases": [
    {
      "id": 1,
      "name": "Agents & Utils Cleanup",
      "status": "pending",
      "tasks": [
        {
          "id": "6.1",
          "description": "Split agents/state-manager.js (851 LOC) into state/{store,queries,mutations}.js",
          "details": "Decompose src/agents/state-manager.js into: store (state initialization, storage, persistence), queries (state reading, filtering, aggregation), mutations (state updates, transitions, validation). Each module <300 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/agents/state-manager.js"]
        },
        {
          "id": "6.2",
          "description": "Split agents/generator.js (832 LOC) into generator/{l1,l2,l3,common}.js by agent level",
          "details": "Decompose src/agents/generator.js by agent hierarchy level: l1 (L1 orchestrator generation), l2 (L2 specialist generation), l3 (L3 worker generation), common (shared utilities, templates, validation). Each module <250 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/agents/generator.js"]
        },
        {
          "id": "6.3",
          "description": "Split utils/version-check.js (925 LOC) into version/{checker,updater,registry}.js",
          "details": "Decompose src/utils/version-check.js into: checker (version comparison, compatibility checking), updater (update detection, download, apply), registry (npm registry queries, package info). Each module <350 lines.",
          "completed": false,
          "agent": "l2-backend-specialist",
          "files": ["src/utils/version-check.js"]
        },
        {
          "id": "6.4",
          "description": "Run full test suite + golden master verification",
          "completed": false,
          "testing": {
            "type": "e2e",
            "command": "npm test"
          }
        }
      ],
      "success_criteria": [
        "state-manager.js reduced to <200 lines (re-export wrapper)",
        "generator.js reduced to <200 lines (re-export wrapper)",
        "version-check.js reduced to <200 lines (re-export wrapper)",
        "All submodules <350 lines",
        "135/135 tests pass"
      ]
    }
  ],
  "testing_config": {
    "ralph_loop": {
      "enabled": true,
      "maxIterations": 10,
      "testCommand": "npm test"
    }
  }
}
